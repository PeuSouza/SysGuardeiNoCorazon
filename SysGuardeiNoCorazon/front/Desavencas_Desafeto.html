<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Desavencas por Desafeto</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
   
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="StylesCadastroDesavencas.css">
 
</head>
<body>
    <center>
    <h1>Aqui estão todas as Desavencas feitas por cada Desafeto</h1>
   <h3><a href= "index.html">Home</a></h3> 
   <div id="main"></div>

   <script>
    //receendo o parametro de outra página
    var idf=parseInt(window.location.href.split("?")[1]);

    fetch("http://localhost:8080/Desafetos/"+ idf, {
      method: "GET",
      headers: { "Content-type": "application/json;charset=UTF-8" },
    })
      .then((data) => data.json())
      .then((json) => {
        console.log(json);
        const divMain = document.getElementById("main");

        let s =
        "<table class='table' border=2>"+
        "<tr><th>id</th><th>Nome</th><th>Apelido</th><th>Sexo</th><th>DeOndeConheco</th><tr><td align=center>${json.id}</td>"+
           ' <td align=center>${json.nome}</td>align<td align=center>${json.apelido}</td><td align=center>${json.sexo}</td><td align=center>${json.deOndeConheco}</td>'+
           ' <td> <button class="btn btn-primary" onclick="cadastrarRegistro(${json.id})">Adicionar Nova desavenca</button></td></tr>'+
        "<tr></tr>"+
        "<tr></tr>"+
        "<tr></tr>"+
        "<tr></tr>"+
        "<tr></tr>"+
        "</table>"+
        "<table class='table' border=2>"+
        "<tr></tr><tr><td></td><td></td><th>Desavencas:</th></tr><tr></tr>"+
        `<tr><td></td><td></td><th>codigo</th><th>data</th><th>hora</th><th>descricao</th><th>motivacao</th><th>local</th><th>desafeto_id</th></tr>`

      json.Desavencas.forEach(element => {
          s+=
           `<tr><td></td><td></td><td align=center>${element.id}</td><td align=center>${element.data}</td><td align=center>${element.hora}</td><td align=center>${element.descricao}</td><td align=center>${element.motivacao}</td><td align=center>${element.local}</td><td align=center>${element.desafeto_id}</td></tr>`+
           "<tr></tr>"+
           "<tr></tr>"+
           "<tr></tr>"+
           "<tr></tr>"+
           "<tr></tr>"+
           "<tr></tr>";

              
          });  
        
        

        s += "</table>";

        divMain.innerHTML = s;
      })
      .catch((err) => {
        document.getElementById("main").innerHTML =
          "Erro ao recuperar a lista";
      });

      async function cadastrarRegistro(id){
  
          window.location='cadastroDesavencas.html?${id}';
      };


  </script>
</center>
</body>
</html>